<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üîó Deeplink Messenger</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* –°–ë–†–û–° –°–¢–ò–õ–ï–ô –ò –ë–ê–ó–û–í–´–ï –ù–ê–°–¢–†–û–ô–ö–ò */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --bg: #0f172a;
            --bg-light: #1e293b;
            --bg-lighter: #334155;
            --text: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #475569;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --radius: 12px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --transition: all 0.2s ease;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        /* –ö–û–ù–¢–ï–ô–ù–ï–†–´ –ò –û–ë–©–ò–ï –ö–õ–ê–°–°–´ */
        .app-container {
            display: flex;
            height: 100vh;
            width: 100vw;
            position: relative;
        }
        
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .hidden {
            transform: translateX(100%);
        }
        
        /* –®–ê–ü–ö–ò */
        .header {
            background: var(--bg-light);
            padding: 16px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--border);
            position: relative;
            min-height: 60px;
        }
        
        .header h1 {
            font-size: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .back-btn {
            background: none;
            border: none;
            color: var(--text);
            font-size: 20px;
            margin-right: 12px;
            padding: 4px;
            display: none;
        }
        
        .header-actions {
            margin-left: auto;
            display: flex;
            gap: 10px;
        }
        
        /* –°–ü–ò–°–ö–ò */
        .list {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 80px;
        }
        
        .list-item {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
            cursor: pointer;
        }
        
        .list-item:hover,
        .list-item.active {
            background: var(--bg-light);
        }
        
        .avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .item-info {
            flex: 1;
            min-width: 0;
        }
        
        .item-title {
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .item-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* –ß–ê–¢ */
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 16px;
            -webkit-overflow-scrolling: touch;
        }
        
        .message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: var(--radius);
            position: relative;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message-incoming {
            background: var(--bg-light);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }
        
        .message-outgoing {
            background: var(--primary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }
        
        .message-system {
            background: var(--bg-lighter);
            align-self: center;
            max-width: 95%;
            font-size: 14px;
            text-align: center;
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 12px;
        }
        
        .message-sender {
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .message-time {
            color: var(--text-secondary);
        }
        
        .message-content {
            line-height: 1.4;
        }
        
        /* –ö–ê–†–¢–û–ß–ö–ò –°–û–û–ë–©–ï–ù–ò–ô */
        .message-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-top: 8px;
            padding: 12px;
            border-left: 4px solid var(--primary);
        }
        
        .task-card {
            border-left-color: var(--success);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .task-completed {
            opacity: 0.7;
            text-decoration: line-through;
        }
        
        .poll-card {
            border-left-color: var(--warning);
        }
        
        .poll-options {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .poll-option {
            background: var(--bg);
            padding: 10px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .poll-option:hover {
            background: var(--bg-light);
        }
        
        .link-card {
            border-left-color: #8b5cf6;
            cursor: pointer;
        }
        
        .link-preview {
            margin-top: 8px;
            padding: 8px;
            background: var(--bg);
            border-radius: 6px;
            font-size: 14px;
        }
        
        .code-card {
            border-left-color: var(--danger);
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        
        /* –ö–ù–û–ü–ö–ò –ò –ò–ù–ü–£–¢–´ */
        .btn {
            padding: 10px 20px;
            border-radius: var(--radius);
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 15px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
        }
        
        .btn-secondary {
            background: var(--bg-light);
            color: var(--text);
        }
        
        .btn-icon {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .input-group {
            position: relative;
            flex: 1;
        }
        
        input, textarea {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-light);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            color: var(--text);
            font-size: 16px;
            transition: var(--transition);
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        /* –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ */
        .bottom-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-light);
            border-top: 1px solid var(--border);
            padding: 12px 16px;
            display: flex;
            gap: 10px;
            align-items: center;
            z-index: 100;
        }
        
        .message-input {
            flex: 1;
            padding: 12px;
            font-size: 16px;
            max-height: 120px;
            resize: none;
        }
        
        .message-type-selector {
            display: flex;
            gap: 6px;
            margin-top: 8px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 4px;
        }
        
        .type-btn {
            padding: 6px 12px;
            background: var(--bg);
            border: none;
            border-radius: 20px;
            color: var(--text-secondary);
            font-size: 14px;
            white-space: nowrap;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .type-btn.active {
            background: var(--primary);
            color: white;
        }
        
        /* –†–ï–ê–ö–¶–ò–ò */
        .message-reactions {
            display: flex;
            gap: 6px;
            margin-top: 8px;
            flex-wrap: wrap;
        }
        
        .reaction {
            background: var(--bg);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .reaction:hover {
            background: var(--bg-light);
        }
        
        .reaction.active {
            background: var(--primary);
            color: white;
        }
        
        /* –ù–ê–°–¢–†–û–ô–ö–ò */
        .settings-list {
            padding: 20px 16px;
            display: flex;
            flex-direction: column;
            gap: 1px;
        }
        
        .setting-item {
            background: var(--bg-light);
            padding: 18px;
            border-radius: var(--radius);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .switch {
            position: relative;
            width: 50px;
            height: 26px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--border);
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background: var(--success);
        }
        
        input:checked + .slider:before {
            transform: translateX(24px);
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ –î–õ–Ø –¢–ï–õ–ï–§–û–ù–û–í */
        @media (max-width: 768px) {
            .back-btn {
                display: block;
            }
            
            .header h1 {
                font-size: 18px;
            }
            
            .avatar {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .message {
                max-width: 90%;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 14px;
            }
            
            .type-btn {
                padding: 6px 10px;
                font-size: 13px;
            }
        }
        
        /* –£–¢–ò–õ–ò–¢–´ */
        .hidden {
            display: none !important;
        }
        
        .online-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }
        
        .badge {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 12px 20px;
            border-radius: var(--radius);
            z-index: 1000;
            animation: slideIn 0.3s ease;
            box-shadow: var(--shadow);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- –≠–ö–†–ê–ù –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò -->
    <div id="registerScreen" class="screen">
        <div class="header">
            <h1>üîó Deeplink Messenger</h1>
        </div>
        
        <div style="padding: 40px 20px; text-align: center; flex: 1; display: flex; flex-direction: column; justify-content: center;">
            <div style="font-size: 80px; margin-bottom: 20px;">ü§ñ</div>
            <h2 style="font-size: 24px; margin-bottom: 10px;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
            <p style="color: var(--text-secondary); margin-bottom: 40px;">
                –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è —Å AI-–ø–æ–º–æ—â–Ω–∏–∫–æ–º, —É–º–Ω—ã–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏ –∏ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
            </p>
            
            <div style="margin-bottom: 30px;">
                <input type="text" id="usernameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" 
                       style="font-size: 18px; padding: 16px; text-align: center;">
            </div>
            
            <button id="registerBtn" class="btn btn-primary" style="padding: 16px; font-size: 18px; width: 100%;">
                <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏ / –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
            </button>
            
            <div style="margin-top: 40px; font-size: 14px; color: var(--text-secondary);">
                <p><i class="fas fa-shield-alt"></i> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ ‚Ä¢ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Ä¢ –ë–µ–∑ –ø–∞—Ä–æ–ª—è</p>
            </div>
        </div>
    </div>
    
    <!-- –≠–ö–†–ê–ù –°–ü–ò–°–ö–ê –ö–ê–ù–ê–õ–û–í -->
    <div id="channelsScreen" class="screen hidden">
        <div class="header">
            <button class="back-btn" onclick="showScreen('registerScreen')">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1>üìÅ –ö–∞–Ω–∞–ª—ã</h1>
            <div class="header-actions">
                <button class="btn btn-icon btn-secondary" onclick="showScreen('settingsScreen')">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>
        
        <div class="list" id="channelsList">
            <!-- –ö–∞–Ω–∞–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            <div class="loading">
                <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–Ω–∞–ª–æ–≤...
            </div>
        </div>
        
        <div class="bottom-panel">
            <button class="btn btn-primary" onclick="createNewChannel()" style="flex: 1;">
                <i class="fas fa-plus"></i> –ù–æ–≤—ã–π –∫–∞–Ω–∞–ª
            </button>
        </div>
    </div>
    
    <!-- –≠–ö–†–ê–ù –ß–ê–¢–ê -->
    <div id="chatScreen" class="screen hidden">
        <div class="header">
            <button class="back-btn" onclick="showScreen('channelsScreen')">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 id="chatTitle">üí¨ –ß–∞—Ç</h1>
            <div class="header-actions">
                <button class="btn btn-icon btn-secondary" onclick="summarizeChat()" id="aiSummaryBtn">
                    <i class="fas fa-robot"></i>
                </button>
            </div>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            <div class="loading">
                <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...
            </div>
        </div>
        
        <div class="bottom-panel">
            <div style="width: 100%;">
                <div class="message-type-selector">
                    <button class="type-btn active" data-type="text">üí¨ –¢–µ–∫—Å—Ç</button>
                    <button class="type-btn" data-type="task">‚úÖ –ó–∞–¥–∞—á–∞</button>
                    <button class="type-btn" data-type="poll">üìä –û–ø—Ä–æ—Å</button>
                    <button class="type-btn" data-type="link">üîó –°—Å—ã–ª–∫–∞</button>
                    <button class="type-btn" data-type="code">üìù –ö–æ–¥</button>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <textarea id="messageInput" class="message-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
                             rows="1"></textarea>
                    <button class="btn btn-primary btn-icon" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –≠–ö–†–ê–ù –ù–ê–°–¢–†–û–ï–ö -->
    <div id="settingsScreen" class="screen hidden">
        <div class="header">
            <button class="back-btn" onclick="showScreen('channelsScreen')">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
        </div>
        
        <div class="settings-list">
            <div class="setting-item">
                <div>
                    <div style="font-weight: 600;">–¢—ë–º–Ω–∞—è —Ç–µ–º–∞</div>
                    <div style="font-size: 14px; color: var(--text-secondary);">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—ë–º–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="darkModeToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="setting-item">
                <div>
                    <div style="font-weight: 600;">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                    <div style="font-size: 14px; color: var(--text-secondary);">–ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="notificationsToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="setting-item">
                <div>
                    <div style="font-weight: 600;">AI-–ø–æ–º–æ—â–Ω–∏–∫</div>
                    <div style="font-size: 14px; color: var(--text-secondary);">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã</div>
                </div>
                <label class="switch">
                    <input type="checkbox" id="aiAssistantToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="setting-item" onclick="showUserInfo()">
                <div>
                    <div style="font-weight: 600;">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</div>
                    <div style="font-size: 14px; color: var(--text-secondary);" id="currentUserInfo">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
                <i class="fas fa-chevron-right"></i>
            </div>
            
            <div class="setting-item" onclick="clearAllData()">
                <div>
                    <div style="font-weight: 600; color: var(--danger);">–û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</div>
                    <div style="font-size: 14px; color: var(--text-secondary);">–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                </div>
                <i class="fas fa-trash" style="color: var(--danger);"></i>
            </div>
            
            <div style="padding: 30px; text-align: center; color: var(--text-secondary); font-size: 14px;">
                Deeplink Messenger v1.0<br>
                <div style="margin-top: 10px; color: var(--primary);">
                    üîó –ì–ª—É–±–æ–∫–∏–µ —Å–≤—è–∑–∏. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–µ—Å–µ–¥—ã.
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== –ì–û–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        let currentUser = null;
        let currentChannel = null;
        let ws = null;
        let messageType = 'text';
        const API_URL = 'http://localhost:8000';
        
        // ========== –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ò –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –í–•–û–î ==========
        async function registerUser() {
            const username = document.getElementById('usernameInput').value.trim();
            if (!username) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'warning');
                return;
            }
            
            try {
                const response = await fetch(`${API_URL}/api/register`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({username})
                });
                
                const data = await response.json();
                currentUser = data.user;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞
                localStorage.setItem('deeplink_user', JSON.stringify(currentUser));
                
                showNotification(data.message || '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!');
                showScreen('channelsScreen');
                loadChannels();
                connectWebSocket();
                
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É', 'danger');
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function tryAutoLogin() {
            const savedUser = localStorage.getItem('deeplink_user');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞
                    fetch(`${API_URL}/api/login`, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({
                            user_id: currentUser.id,
                            token: currentUser.token
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            showScreen('channelsScreen');
                            loadChannels();
                            connectWebSocket();
                        }
                    })
                    .catch(() => {
                        // –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞–Ω–∞–ª—ã
                        showScreen('channelsScreen');
                        loadChannels();
                    });
                } catch (e) {
                    localStorage.removeItem('deeplink_user');
                }
            }
        }
        
        // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –≠–ö–†–ê–ù–ê–ú–ò ==========
        function showScreen(screenName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω
            const screen = document.getElementById(screenName);
            screen.classList.remove('hidden');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
            if (screenName === 'settingsScreen' && currentUser) {
                document.getElementById('currentUserInfo').textContent = 
                    `${currentUser.username} ‚Ä¢ ${currentUser.id}`;
            }
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–≤–µ—Ä—Ö
            window.scrollTo(0, 0);
        }
        
        // ========== –†–ê–ë–û–¢–ê –° –ö–ê–ù–ê–õ–ê–ú–ò ==========
        async function loadChannels() {
            try {
                const response = await fetch(`${API_URL}/api/channels`);
                const data = await response.json();
                
                const container = document.getElementById('channelsList');
                container.innerHTML = '';
                
                data.channels.forEach(channel => {
                    const lastMessage = '–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π';
                    const memberCount = channel.members ? channel.members.length : 0;
                    
                    const channelEl = document.createElement('div');
                    channelEl.className = 'list-item';
                    channelEl.onclick = () => openChannel(channel);
                    
                    channelEl.innerHTML = `
                        <div class="avatar">${getChannelIcon(channel.type)}</div>
                        <div class="item-info">
                            <div class="item-title">
                                <span>${channel.name}</span>
                                <span class="badge">${memberCount}</span>
                            </div>
                            <div class="item-subtitle">${lastMessage}</div>
                        </div>
                    `;
                    
                    container.appendChild(channelEl);
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–Ω–ª–∞–π–Ω-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                const onlineUsers = data.users.filter(u => u.online);
                if (onlineUsers.length > 0) {
                    const onlineEl = document.createElement('div');
                    onlineEl.style.padding = '16px';
                    onlineEl.style.borderBottom = '1px solid var(--border)';
                    onlineEl.style.fontSize = '14px';
                    onlineEl.innerHTML = `üü¢ –û–Ω–ª–∞–π–Ω: ${onlineUsers.map(u => u.username).join(', ')}`;
                    container.insertBefore(onlineEl, container.firstChild);
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–Ω–∞–ª–æ–≤:', error);
            }
        }
        
        function getChannelIcon(type) {
            const icons = {
                'chat': 'üí¨',
                'kanban': 'üìã',
                'media': 'üñºÔ∏è',
                'forum': 'üìö'
            };
            return icons[type] || 'üìÅ';
        }
        
        async function createNewChannel() {
            const name = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞:', '–ù–æ–≤—ã–π –∫–∞–Ω–∞–ª');
            if (!name) return;
            
            const type = prompt('–¢–∏–ø –∫–∞–Ω–∞–ª–∞ (chat, kanban, media, forum):', 'chat');
            
            try {
                const response = await fetch(`${API_URL}/api/channels/create`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({name, type})
                });
                
                const data = await response.json();
                if (data.success) {
                    showNotification(`–ö–∞–Ω–∞–ª "${name}" —Å–æ–∑–¥–∞–Ω`);
                    loadChannels();
                }
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–Ω–∞–ª–∞', 'danger');
            }
        }
        
        // ========== –†–ê–ë–û–¢–ê –° –ß–ê–¢–û–ú ==========
        async function openChannel(channel) {
            currentChannel = channel;
            document.getElementById('chatTitle').textContent = channel.name;
            showScreen('chatScreen');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
            try {
                const response = await fetch(`${API_URL}/api/messages/${channel.id}?limit=100`);
                const messages = await response.json();
                displayMessages(messages);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:', error);
            }
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
            setTimeout(() => {
                const messagesContainer = document.getElementById('chatMessages');
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 100);
        }
        
        function displayMessages(messages) {
            const container = document.getElementById('chatMessages');
            container.innerHTML = '';
            
            messages.forEach(msg => {
                const messageEl = createMessageElement(msg);
                container.appendChild(messageEl);
            });
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
            container.scrollTop = container.scrollHeight;
        }
        
        function createMessageElement(msg) {
            const isCurrentUser = msg.sender_id === currentUser?.id;
            const isSystem = msg.sender_id === 'system' || msg.metadata?.system;
            const isAI = msg.sender_id === 'ai_bot' || msg.metadata?.ai;
            
            let messageClass = isCurrentUser ? 'message-outgoing' : 'message-incoming';
            if (isSystem) messageClass = 'message-system';
            if (isAI) messageClass = 'message-incoming';
            
            const messageEl = document.createElement('div');
            messageEl.className = `message ${messageClass}`;
            messageEl.id = `msg_${msg.id}`;
            
            let content = '';
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
            switch(msg.type) {
                case 'task':
                    const completed = msg.metadata?.completed;
                    content = `
                        <div class="message-card task-card ${completed ? 'task-completed' : ''}">
                            <div>
                                <strong>‚úÖ –ó–∞–¥–∞—á–∞:</strong><br>
                                ${msg.content}
                            </div>
                            ${!completed ? `
                                <button class="btn btn-icon btn-secondary" onclick="completeTask('${msg.id}')">
                                    <i class="fas fa-check"></i>
                                </button>
                            ` : `<span style="color: var(--success);"><i class="fas fa-check-circle"></i> –í—ã–ø–æ–ª–Ω–µ–Ω–æ</span>`}
                        </div>
                    `;
                    break;
                    
                case 'poll':
                    const options = msg.metadata?.options || ['–î–∞', '–ù–µ—Ç'];
                    const votes = msg.metadata?.votes || {};
                    const userVote = votes[currentUser?.id];
                    
                    content = `
                        <div class="message-card poll-card">
                            <strong>üìä –û–ø—Ä–æ—Å:</strong><br>
                            ${msg.content}
                            <div class="poll-options">
                                ${options.map((opt, idx) => {
                                    const voteCount = Object.values(votes).filter(v => v === opt).length;
                                    const isSelected = userVote === opt;
                                    return `
                                        <div class="poll-option ${isSelected ? 'active' : ''}" 
                                             onclick="voteForPoll('${msg.id}', '${opt}')">
                                            <span>${opt}</span>
                                            <span>${voteCount} üëç</span>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'link':
                    content = `
                        <div class="message-card link-card" onclick="window.open('${msg.content}', '_blank')">
                            <strong>üîó –°—Å—ã–ª–∫–∞:</strong><br>
                            ${msg.content}
                            <div class="link-preview">
                                <strong>${msg.metadata?.title || '–°—Å—ã–ª–∫–∞'}</strong><br>
                                <small>${msg.metadata?.description || '–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞'}</small>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'code':
                    content = `
                        <div class="message-card code-card">
                            <strong>üìù –ö–æ–¥:</strong><br>
                            <pre style="margin: 8px 0; overflow-x: auto;">${msg.content}</pre>
                        </div>
                    `;
                    break;
                    
                default:
                    content = msg.content;
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∞–∫—Ü–∏–∏
            let reactionsHtml = '';
            if (msg.reactions && Object.keys(msg.reactions).length > 0) {
                reactionsHtml = `
                    <div class="message-reactions">
                        ${Object.entries(msg.reactions).map(([emoji, users]) => {
                            const hasReacted = users.includes(currentUser?.id);
                            return `
                                <div class="reaction ${hasReacted ? 'active' : ''}" 
                                     onclick="toggleReaction('${msg.id}', '${emoji}')">
                                    ${emoji} ${users.length}
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
            }
            
            messageEl.innerHTML = `
                <div class="message-header">
                    <div class="message-sender">
                        ${isAI ? 'ü§ñ' : ''}
                        ${isSystem ? 'üîî' : ''}
                        ${!isCurrentUser && !isSystem && !isAI ? msg.sender_avatar || 'üë§' : ''}
                        ${msg.sender_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π'}
                    </div>
                    <div class="message-time">${msg.timestamp}</div>
                </div>
                <div class="message-content">${content}</div>
                ${reactionsHtml}
                <div style="margin-top: 8px; display: flex; gap: 8px;">
                    <button class="reaction" onclick="toggleReaction('${msg.id}', 'üëç')">üëç</button>
                    <button class="reaction" onclick="toggleReaction('${msg.id}', '‚ù§Ô∏è')">‚ù§Ô∏è</button>
                    <button class="reaction" onclick="toggleReaction('${msg.id}', 'üòÇ')">üòÇ</button>
                    <button class="reaction" onclick="toggleReaction('${msg.id}', 'üòÆ')">üòÆ</button>
                </div>
            `;
            
            return messageEl;
        }
        
        // ========== –û–¢–ü–†–ê–í–ö–ê –°–û–û–ë–©–ï–ù–ò–ô ==========
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const content = input.value.trim();
            
            if (!content || !currentUser || !currentChannel) {
                return;
            }
            
            const messageData = {
                type: messageType,
                content: content,
                sender_id: currentUser.id,
                channel_id: currentChannel.id,
                metadata: {}
            };
            
            // –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            if (messageType === 'task') {
                messageData.metadata = { completed: false };
            } else if (messageType === 'poll') {
                messageData.metadata = { options: ['–î–∞', '–ù–µ—Ç', '–í–æ–∑–º–æ–∂–Ω–æ'] };
            }
            
            try {
                const response = await fetch(`${API_URL}/api/message/send`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(messageData)
                });
                
                const data = await response.json();
                if (data.success) {
                    input.value = '';
                    input.style.height = 'auto';
                }
                
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è', 'danger');
            }
        }
        
        // ========== –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ï –° –°–û–û–ë–©–ï–ù–ò–Ø–ú–ò ==========
        async function toggleReaction(messageId, emoji) {
            if (!currentUser || !currentChannel) return;
            
            try {
                await fetch(`${API_URL}/api/message/react`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        message_id: messageId,
                        channel_id: currentChannel.id,
                        user_id: currentUser.id,
                        emoji: emoji
                    })
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–∞–∫—Ü–∏–∏:', error);
            }
        }
        
        async function completeTask(messageId) {
            if (!currentUser || !currentChannel) return;
            
            try {
                await fetch(`${API_URL}/api/message/update`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        message_id: messageId,
                        channel_id: currentChannel.id,
                        action: 'complete_task',
                        user_id: currentUser.id
                    })
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
            }
        }
        
        async function voteForPoll(messageId, option) {
            if (!currentUser || !currentChannel) return;
            
            try {
                await fetch(`${API_URL}/api/message/update`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        message_id: messageId,
                        channel_id: currentChannel.id,
                        action: 'vote',
                        user_id: currentUser.id,
                        option: option
                    })
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:', error);
            }
        }
        
        async function summarizeChat() {
            if (!currentChannel) return;
            
            const btn = document.getElementById('aiSummaryBtn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            
            try {
                const response = await fetch(`${API_URL}/api/ai/summarize`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({channel_id: currentChannel.id})
                });
                
                const data = await response.json();
                showNotification(data.summary);
                
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ AI-—Å–µ—Ä–≤–∏—Å–∞', 'danger');
            } finally {
                btn.innerHTML = '<i class="fas fa-robot"></i>';
            }
        }
        
        // ========== WEB SOCKET ==========
        function connectWebSocket() {
            if (!currentUser) return;
            
            if (ws) {
                ws.close();
            }
            
            ws = new WebSocket(`ws://localhost:8000/ws/${currentUser.id}`);
            
            ws.onopen = () => {
                console.log('WebSocket –ø–æ–¥–∫–ª—é—á—ë–Ω');
            };
            
            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                
                switch(data.type) {
                    case 'new_message':
                        if (currentChannel && data.message.channel_id === currentChannel.id) {
                            const messageEl = createMessageElement(data.message);
                            document.getElementById('chatMessages').appendChild(messageEl);
                            
                            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
                            const container = document.getElementById('chatMessages');
                            container.scrollTop = container.scrollHeight;
                            
                            // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
                            if (data.message.sender_id !== currentUser.id) {
                                showNotification(`–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç ${data.message.sender_name}`);
                            }
                        }
                        break;
                        
                    case 'message_updated':
                        if (currentChannel && data.channel_id === currentChannel.id) {
                            const msgEl = document.getElementById(`msg_${data.message_id}`);
                            if (msgEl) {
                                // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∞–∫—Ü–∏–∏
                                const reactionsEl = msgEl.querySelector('.message-reactions');
                                if (reactionsEl) {
                                    reactionsEl.innerHTML = Object.entries(data.reactions || {})
                                        .map(([emoji, users]) => `
                                            <div class="reaction ${users.includes(currentUser.id) ? 'active' : ''}" 
                                                 onclick="toggleReaction('${data.message_id}', '${emoji}')">
                                                ${emoji} ${users.length}
                                            </div>
                                        `).join('');
                                }
                            }
                        }
                        break;
                }
            };
            
            ws.onerror = (error) => {
                console.error('WebSocket –æ—à–∏–±–∫–∞:', error);
            };
            
            ws.onclose = () => {
                console.log('WebSocket –æ—Ç–∫–ª—é—á—ë–Ω, –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...');
                setTimeout(connectWebSocket, 3000);
            };
        }
        
        // ========== –ù–ê–°–¢–†–û–ô–ö–ò ==========
        function showUserInfo() {
            if (currentUser) {
                alert(`üë§ –í–∞—à –ø—Ä–æ—Ñ–∏–ª—å:\n\n–ò–º—è: ${currentUser.username}\nID: ${currentUser.id}\n–¢–æ–∫–µ–Ω: ${currentUser.token}\n\n–≠—Ç–æ—Ç —Ç–æ–∫–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞.`);
            }
        }
        
        function clearAllData() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –ë—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.')) {
                localStorage.clear();
                showNotification('–î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã');
                setTimeout(() => location.reload(), 1000);
            }
        }
        
        // ========== –£–¢–ò–õ–ò–¢–´ ==========
        function showNotification(text, type = 'success') {
            // –°–æ–∑–¥–∞—ë–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = text;
            notification.style.background = type === 'danger' ? 'var(--danger)' : 'var(--success)';
            
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        document.addEventListener('DOMContentLoaded', function() {
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥
            tryAutoLogin();
            
            // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
            document.getElementById('registerBtn').addEventListener('click', registerUser);
            document.getElementById('usernameInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') registerUser();
            });
            
            // –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            document.querySelectorAll('.type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    messageType = this.dataset.type;
                });
            });
            
            // –ê–≤—Ç–æ–ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ –≤—ã—Å–æ—Ç—ã —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è
            const textarea = document.getElementById('messageInput');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 120) + 'px';
            });
            
            textarea.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
            document.getElementById('darkModeToggle').addEventListener('change', function() {
                document.body.classList.toggle('light-mode', !this.checked);
            });
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            const savedSettings = localStorage.getItem('deeplink_settings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                document.getElementById('darkModeToggle').checked = settings.darkMode !== false;
                document.getElementById('notificationsToggle').checked = settings.notifications !== false;
                document.getElementById('aiAssistantToggle').checked = settings.aiAssistant !== false;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
            document.querySelectorAll('.switch input').forEach(toggle => {
                toggle.addEventListener('change', function() {
                    const settings = {
                        darkMode: document.getElementById('darkModeToggle').checked,
                        notifications: document.getElementById('notificationsToggle').checked,
                        aiAssistant: document.getElementById('aiAssistantToggle').checked
                    };
                    localStorage.setItem('deeplink_settings', JSON.stringify(settings));
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–∞–π–ø–æ–≤ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
            let touchStartX = 0;
            document.addEventListener('touchstart', e => {
                touchStartX = e.touches[0].clientX;
            });
            
            document.addEventListener('touchend', e => {
                const touchEndX = e.changedTouches[0].clientX;
                const diff = touchStartX - touchEndX;
                
                if (Math.abs(diff) > 50) { // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è —Å–≤–∞–π–ø–∞
                    const screens = ['registerScreen', 'channelsScreen', 'chatScreen', 'settingsScreen'];
                    const currentScreen = screens.find(id => !document.getElementById(id).classList.contains('hidden'));
                    const currentIndex = screens.indexOf(currentScreen);
                    
                    if (diff > 0 && currentIndex < screens.length - 1) {
                        // –°–≤–∞–π–ø –≤–ª–µ–≤–æ -> —Å–ª–µ–¥—É—é—â–∏–π —ç–∫—Ä–∞–Ω
                        showScreen(screens[currentIndex + 1]);
                    } else if (diff < 0 && currentIndex > 0) {
                        // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ -> –ø—Ä–µ–¥—ã–¥—É—â–∏–π —ç–∫—Ä–∞–Ω
                        showScreen(screens[currentIndex - 1]);
                    }
                }
            });
        });
    </script>
</body>
</html>
